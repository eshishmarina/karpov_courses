# karpov_courses
В репозитории собраны практические работы из курса "Симулятор аналитика".
В курсе для работы была представлена база `Clickhouse` с двумя таблицами, которые содержат данные пользователей двух сервисов: ленты новостей и мессенджера. Были записаны такие данные пользователей, как: дата и время действия, действие, пол, возраст, страна и город пребывания, операционная система устройства пользователя, присвоенная группа для AB тестирования.

Файлы task_1, task_2, task_3 содержат задания по AA и AB тестированию. 

[task_1](task_1.ipynb) - проверка, что система сплитования работает корректно при помощи метода бутстрепа;

[task_2](task_2.ipynb) - проведение AB тестов при помощи разных методов: t-тест, тест Манна-Уитни, t-тест и Манна-Уитни по сглаженному CTR, бутстреп, бакетное преобразование. Далее приведено обоснование того, какой из этих тестов подходит больше для выборок и анализ результатов тестирования;

[task_3](task_3.ipynb) - AB тест на метрике линеаризованных лайков.

Файл [dag](dag.py) посвящен ETL задаче. ETL выполнялся в несколько этапов, каждый из которых был обернут в task в `Airflow`. Отчет настроен так, что выполняется ежедневно в определенное время. 
Этапы выполнения:
1) `SQL`-запросами достали данные по метрикам из двух таблиц базы
2) Результаты предыдущего шага объединены в одну таблицу с помощью `pandas`
3) Данные в таблице сгруппированы по необходимым срезам: полу, возрасту пользователей и операционной системы устройства пользователей
4) Создаем таблицу в базе, куда будут записываться результаты ETL

Файлы [feed_bot](feed_bot.py) и [feed_news_bot](feed_news_bot.py) содержат код для автоматизации отправки ежедневных отчетов в Telegram. Для этого с помощью SQL-запросов посчитаны метрики, например, DAU, количество лайков и просмотров, CTR. И динамика изменения метрик запечатлена на графиках с помощью `matplotlib`. Автоматизация отчета также была выполнена через Airflow, ежедневно в одно и то же время в Telegram пользователю отправляется текстовое сообщение со значениями метрик и графики.

Файл [alerts_test](alerts_test.py) содержит код по проверке аномалий в данных и отправлению отчетов в Telegram в случае аномалий. Аномалии проверялись функцией межквартильного размаха в 15-минутных интервалах. Метрики для анализа: CTR, DAU, просмотры, лайки, отправленные и полученные сообщения.
